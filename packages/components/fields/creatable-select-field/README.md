# CreatableSelectField

## Description

A controlled input component with validation states and a label getting a selection from the user, and where options can also be created by the user.

## Usage

```js
import CreatableSelectField from '@commercetools-uikit/creatable-select-field';

<CreatableSelectField
  title="State"
  value="ready"
  options={[
    { value: 'ready', label: 'Ready' },
    { value: 'shipped', label: 'Shipped' },
  ]}
  onChange={(event) => alert(event.target.value)}
/>;
```

## Properties

| Props                     | Type               | Required | Values                  | Default  | Description                                                                                                                                                                                                                                                                                 |
| ------------------------- | ------------------ | :------: | ----------------------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `id`                      | `string`           |    -     | -                       | -        | Used as HTML `id` property. An `id` is generated automatically when not provided.                                                                                                                                                                                                           |
| `horizontalConstraint`    | `object`           |    -     | `m`, `l`, `xl`, `scale` | `scale`  | Horizontal size limit of the field.                                                                                                                                                                                                                                                         |
| `errors`                  | `object`           |    -     | -                       | -        | A map of errors. Error messages for known errors are rendered automatically. Unknown errors will be forwarded to `renderError`.                                                                                                                                                             |
| `renderError`             | `function`         |    -     | -                       | -        | Called with custom errors, as `renderError(key, error)`. This function can return a message which will be wrapped in an `ErrorMessage`. It can also return `null` to show no error.                                                                                                         |
| `hasWarning`              | `bool`             |    -     | -                       | -        | Indicates that the field has a warning                                                                                                                                                                                                                                                      |
| `isRequired`              | `bool`             |    -     | -                       | `false`  | Indicates if the value is required. Shows an the "required asterisk" if so.                                                                                                                                                                                                                 |
| `touched`                 | `bool`             |    -     | -                       | `false`  | Indicates whether the field was touched. Errors will only be shown when the field was touched.                                                                                                                                                                                              |
| `aria-label`              | `string`           |    -     | -                       | -        | Aria label (for assistive tech)                                                                                                                                                                                                                                                             |
| `aria-labelledby`         | `string`           |    -     | -                       | -        | HTML ID of an element that should be used as the label (for assistive tech)                                                                                                                                                                                                                 |
| `isAutofocussed`          | `bool`             |    -     | -                       | -        | Focus the control when it is mounted                                                                                                                                                                                                                                                        |
| `backspaceRemovesValue`   | `bool`             |    -     | -                       | `true`   | Remove the currently focused option when the user presses backspace                                                                                                                                                                                                                         |
| `components`              | `objectOf(func)`   |    -     | -                       | -        | Map of components to overwrite the default ones, see [what components you can override](https://react-select.com/components)                                                                                                                                                                |
| `filterOption`            | `func`             |    -     | -                       | -        | Custom method to filter whether an option should be displayed in the menu                                                                                                                                                                                                                   |
| `containerId`             | `string`           |    -     | -                       | -        | The id to set on the SelectContainer component                                                                                                                                                                                                                                              |
| `isClearable`             | `bool`             |    -     | -                       | -        | Is the select value clearable                                                                                                                                                                                                                                                               |
| `isDisabled`              | `bool`             |    -     | -                       | -        | Is the select disabled                                                                                                                                                                                                                                                                      |
| `isReadOnly`              | `bool`             |    -     | -                       | -        | Is the select read-only                                                                                                                                                                                                                                                                     |
| `isOptionDisabled`        | `func`             |    -     | -                       | -        | Override the built-in logic to detect whether an option is disabled                                                                                                                                                                                                                         |
| `isMulti`                 | `bool`             |    -     | -                       | -        | Support multiple selected options                                                                                                                                                                                                                                                           |
| `isSearchable`            | `bool`             |    -     | -                       | -        | Whether to enable search functionality                                                                                                                                                                                                                                                      |
| `maxMenuHeight`           | `number`           |    -     | -                       | -        | Maximum height of the menu before scrolling                                                                                                                                                                                                                                                 |
| `menuPortalTarget`        | `HTMLElement`      |    -     | -                       | -        | Dom element to portal the select menu to                                                                                                                                                                                                                                                    |
| `menuPortalZIndex`        | `number`           |    -     | -                       | -        | z-index value for the menu portal                                                                                                                                                                                                                                                           |
| `menuShouldBlockScroll`   | `bool`             |    -     | -                       | `false`  | whether the menu should block scroll while open                                                                                                                                                                                                                                             |
| `name`                    | `string`           |    -     | -                       | -        | Name of the HTML Input (optional - without this, no input will be rendered)                                                                                                                                                                                                                 |
| `noOptionsMessage`        | `func`             |    -     | -                       | -        | Can be used to render a custom value when there are no options (either because of no search results, or all options have been used, or there were none in the first place). Gets called with `{ inputValue: String }`. `inputValue` will be an empty string when no search text is present. |
| `onBlur`                  | `func`             |    -     | -                       | -        | Handle blur events on the control                                                                                                                                                                                                                                                           |
| `onChange`                | `func`             |    ✅    | -                       | -        | Called with a fake event when value changes. The event's `target.name` will be the `name` supplied in props. The event's `target.value` will hold the value. The value will be the selected option, or an array of options in case `isMulti` is `true`.                                     |
| `onFocus`                 | `func`             |    -     | -                       | -        | Handle focus events on the control                                                                                                                                                                                                                                                          |
| `onInputChange`           | `func`             |    -     | -                       | -        | Handle change events on the input                                                                                                                                                                                                                                                           |
| `options`                 | `arrayOf()`        |    -     | -                       | -        | Array of options that populate the select menu                                                                                                                                                                                                                                              |
| `placeholder`             | `string`           |    -     | -                       | -        | Placeholder text for the select value                                                                                                                                                                                                                                                       |
| `tabIndex`                | `string`           |    -     | -                       | `"0"`    | Sets the tabIndex attribute on the input                                                                                                                                                                                                                                                    |
| `tabSelectsValue`         | `bool`             |    -     | -                       | `true`   | Select the currently focused option when the user presses tab                                                                                                                                                                                                                               |
| `value`                   | `object` / `array` |    -     | -                       | -        | The value of the select; reflected by the selected option                                                                                                                                                                                                                                   |
| `allowCreateWhileLoading` | `bool`             |    -     | -                       | -        | Allow options to be created while the isLoading prop is true. Useful to prevent the "create new ..." option being displayed while async results are still being loaded.                                                                                                                     |
| `formatCreateLabel`       | `func`             |    -     | -                       | -        | Gets the label for the "create new ..." option in the menu. Is given the current input value.                                                                                                                                                                                               |
| `isValidNewOption`        | `func`             |    -     | -                       | -        | Determines whether the "create new ..." option should be displayed based on the current input value, select value and options array.                                                                                                                                                        |
| `getNewOptionData`        | `func`             |    -     | -                       | -        | Returns the data for the new option when it is created. Used to display the value, and is passed to onChange.                                                                                                                                                                               |
| `onCreateOption`          | `func`             |    -     | -                       | -        | If provided, this will be called with the input value when a new option is created, and onChange will not be called. Use this when you need more control over what happens when new options are created.                                                                                    |
| `createOptionPosition`    | `string`           |    -     | `"first"`, `"last"`     | `"last"` | Sets the position of the createOption element in your options list.                                                                                                                                                                                                                         |
| `title`                   | `string` or `node` |    ✅    | -                       | -        | Title of the label                                                                                                                                                                                                                                                                          |
| `hint`                    | `string` or `node` |    -     | -                       | -        | Hint for the label. Provides a supplementary but important information regarding the behaviour of the input (e.g warn about uniqueness of a field, when it can only be set once), whereas `description` can describe it in more depth. Can also receive a `hintIcon`.                       |
| `description`             | `string` or `node` |    -     | -                       | -        | Provides a description for the title.                                                                                                                                                                                                                                                       |
| `onInfoButtonClick`       | `function`         |    -     | -                       | -        | Function called when info button is pressed. Info button will only be visible when this prop is passed.                                                                                                                                                                                     |
| `hintIcon`                | `node`             |    -     | -                       | -        | Icon to be displayed beside the hint text. Will only get rendered when `hint` is passed as well.                                                                                                                                                                                            |
| `badge`                   | `node`             |    -     | -                       | -        | Badge to be displayed beside the label. Might be used to display additional information about the content of the field (E.g verified email)                                                                                                                                                 |
| `iconLeft`                | `node`             |    -     | -                       |          | Icon to display on the left of the placeholder text and selected value. Has no effect when `isMulti` is enabled.                                                                                                                                                                            |

The component further forwards all `data-` attributes to the underlying `CreatableSelectInput` component.

This input is built on top of [`react-select`](https://github.com/JedWatson/react-select) v2.
It supports mostly same properties as `react-select`. Behaviour for some props was changed, and support for others was dropped.

In case you need one of the currently excluded props, feel free to open a PR adding them.

## `errors`

This object is a key-value map. The `renderError` prop will be called for each entry with the key and the value. The return value will be rendered inside an `ErrorMessage` component underneath the input.

The `CreatableSelectField` supports some errors out of the box. Return `undefined` from `renderError` for these and the default errors will be shown instead. This prevents consumers from having to reimplement the same error messages for known errors while still keeping the flexibility of showing custom error messages for them.

When the `key` is known, and when the value is truthy, and when `renderError` returned `undefined` for that error entry, then the `CreatableSelectField` will render an appropriate error automatically.

Known error keys are:

- `missing`: tells the user that this field is required
